---
title: "final"
author: "Ting-fen Lin"
date: "2/21/2019"
output: pdf_document
---

```{r setup, include = FALSE}
library("dplyr")
library("tidyverse")
library("rio")
library("here")
library("forcats")
library("fivethirtyeight")
library("wesanderson")
library("ggplot")
library("ggplot2")
library("gdata")
library("viridis")
library("colorblindr")
library("stringr")
library("tidytext")
knitr::opts_chunk$set(warning = FALSE,
                      message = FALSE,
                      error = TRUE,
                      fig.width = 6.5,
                      fig.height = 8
                      )
theme_set(theme_minimal(base_size = 8))
```


```{r resize}
# Resize plot
knitr::opts_chunk$set(fig.width=12, fig.height=8) 
```


```{r demographics}
SKY <- import(here("data", "survey.xlsx"), setclass = "tbl_df") 

str(SKY)

Fig1.1 <- ggplot(SKY, aes(x = Category)) +
  geom_histogram(stat = "Count",
                 fill = "#56B4E9",
                 color = "white",
                 alpha = 0.7) 
Fig1.1

Fig1.2 <- ggplot(SKY, aes(x = Category,
                decreasing = TRUE)) +
  geom_histogram(stat = "count",
                 color = "white",
                 alpha = 0.7) +
  scale_y_continuous(breaks = seq(0, 11, by = 1)) +
  scale_fill_OkabeIto() +
  coord_flip() +
  labs(x = "Category",
       y = "Count",
       title = "Where do participants come from?") +
    theme_minimal(base_size = 15)
Fig1.2
```


```{r survey recommend}


Fig2.1 <- ggplot(SKY, x = 0:5, aes(Recommend, Category)) +
   ggridges::geom_density_ridges(color = "white",
                                alpha = 0.4) +
  scale_color_OkabeIto() +
    labs(x = "Five-point Liker Scale (No-Yes)",
       y = "Category",
       title = "I would recommend this training to my peers as they would benefit from it") 
Fig2.1


Fig2.2 <- ggplot(SKY, x = 0:5, aes(Recommend, Category)) +
   ggridges::geom_density_ridges(color = "white",
                                alpha = 0.4) +
  scale_color_OkabeIto() +
    labs(x = "Five-point Liker Scale (No-Yes)",
       y = "Category",
       title = "I would recommend this training to my peers as they would benefit from it") 
Fig2.2


```


```{r survey response quantitative}
ggplot(SKY, aes())
```




```{r survey response qualitative}

experience <- c("I thought it was positive and powerful",
                "It was very beautiful. It felt like truth",
                "Fantastic growth experience",
                "Wonderful! There were physically challenging moments while sitting for Sudarshan Kriya but I benefited a lot & have smiled more during this retreat than I have in a month",
                "I had a wonderful experience. I had been feeling very unbalanced and uncertain. I now feel much better and more centered",
                "I feel empowered and enlightened",
                "Very positive! Uplifting. Beautiful. Meaningful",
                "Great! I feel more relaxed, confident & can concentrate more on what I am doing",
                "So positive! I feel more capable of managing the things that come my way, and more open to others",
                "It was enlightening and freeing",
                "It was completely transformative. I LOVED it and felt so grateful for Sarah and Ting-fen and all their knowledge",
                "Wonderful!",
                "Kind. Open. Good experience",
                "Very positive, nurturing, and invigorating",
                "Nice. Learned so many new things",
                "Very positive and good use of time",
                "Amazing! So calming, welcoming, and educational",
                "Pretty amazing",
                "Amazing",
                "I enjoyed it",
                "It was great")

experience_df <- tibble(line = 1:21, text = experience)

experience_df %>%
  unnest_tokens(word, text)

data(stop_words)

experience_df <- experience_df %>%
  anti_join(stop_words)

experience_df %>%
  count(word, sort = TRUE)






experience_df  %>%
  count(word, sort = TRUE) %>%
  filter (n > 600) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_col() +
  xlab(NULL) +
  coord_flip()
  



```

